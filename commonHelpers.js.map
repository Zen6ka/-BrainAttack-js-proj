{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart.js"],"sourcesContent":["// import { onOpenModal, onCloseModal,  } from \"./modal.js\";\n\n\nconst cartItemsQuantity = document.querySelector(\".js-cart-items-quantity\"); // Місце де буде оновлюватись кількість товарів в кошику\nconst cartEmpty = document.querySelector(\".js-cart-empty\");\nconst cartContainer = document.querySelector(\".js-cart-container\");\nconst deleteAllBtn = document.querySelector('.js-delete-all-btn');\nconst cartSelectedProducts = document.querySelector(\".js-cart-selected-products\");\nconst cartOrderDetails = document.querySelector(\".js-cart-order-details\");\nconst totalOrderedPrice = document.querySelector(\".js-total-ordered-price\");\nconst form = document.querySelector(\".js-email-form\");\nconst btnCheckout = document.querySelector(\".js-email-checkout\");\nconst input = document.querySelector(\".input\")\n\n// const cartAmount = document.querySelector('.cart-amount')\n\n\nconsole.log(\"Test start\");\n// За замовчуванням сторінка кошика буде пустою.\ncartEmptyHidden();\ncartContainerHidden();\n\n\n// ФУНКЦІЯ ПЕРЕВІРКИ ЛОКАЛЬНОГО СХОВИЩА НА ВМІСТ ДАНИХ\nfunction localStorageCheck() { // ****** пізніше підшаманити, щоб просто повертати результат сховище, а логіку відпрацьовувати далі поза функцією.\n  const savedProducts = localStorage.getItem(\"cart\");\n  return   JSON.parse(savedProducts); //повертаю розпарсені дані з ЛС або null якщо там нічого не має\n}\n// savedProducts ?   : null\n\nconst parsedSavedProducts = localStorageCheck(); // результат повернення передаю змінній Розпарсених даних\nconsole.log(parsedSavedProducts) // Масив всіх об`єктів з ЛС за ключем cart\n\n\n// // Функція перевірки об`єктів в масиві отриманого зі сховища і повернення лише унікальних значень. \n// const seen = new Set(); // Створюємо пустий Set для відстеження унікальних значень\n// const parsedSavedProducts = parsedSavedProducts.filter(obj => {\n//   const value = obj._id; // В нашому прикладі вибираємо значення \"id\" для порівняння унікальності\n//   if (seen.has(value)) {\n//     return false; // Значення вже було, це не унікальний об'єкт\n//   }\n//   seen.add(value); // Додаємо значення до Set, оскільки це унікальне\n//   return true; // Об'єкт є унікальним і буде включений до результату\n// });\n\n// console.log(uniqueProductsArray); //  Масив унікальних об`єктів з ЛС за ключем cart\n// // Якщо треба буде перевіряти масив зі сховища, щоб дані не повторювались, тоді використаю цю функцію, \n// //а далі для роблти в решті коду буду передавати отриманий масив унікальних об`єктів (типу цей uniqueProductsArray).\n\n\n\n\n\n// Основна логіка запиту\n// Всюди замість exampleLS треба використвувати оригінал, тобто parsedSavedProducts\nif (parsedSavedProducts === null || parsedSavedProducts.length < 1) {\n  cartItemsQuantity.innerHTML = '0';\n  cartEmptyShow();\ncartContainerHidden();\n } else {\n\ncartItemsQuantity.innerHTML = parsedSavedProducts.length;\n\n  cartEmptyHidden();\n  cartContainerShow();\n\n  //-------Тут треба буде глянути що саме повертається і в якому вигляді.\n  const { _id, name, img, category, size, price } = parsedSavedProducts; // повинен повертатись об`єкт за запитом до сховища. Тому одразу роблю його деструктуризацію, щоб потім відмальовувати розмітку.\n//   const { ProductId, ProductName, ProductImg, ProductCategory, ProductSize, ProductPrice } = parsedSavedProducts; - або в такому вигляді буде повертатись.\n  \n// Повернення масиву об`єктів і відмальовування їх\n  const productsArrayMarkup = parsedSavedProducts.map(el => {\n    return selectedProductsMarkup(el._id, el.name, el.img, el.category, el.size, el.price) \n    // return selectedProductsMarkup(el._id, el.Productame, el.ProductImg, el.ProductCategory, el.ProductSize, el.ProductPrice) -або так\n  }).join('');\n  \n  // console.log(productsArrayMarkup.length); // там 4435 цифра, але це всього лиш кількість символів які нам повернулись.\n\n\n  cartSelectedProducts.innerHTML = productsArrayMarkup;\n  cartItemsQuantity.innerHTML = parsedSavedProducts.length;\n\n  totalSumMarkup(parsedSavedProducts);\n\n\n/// слухач на форму форму продуктів які ми отримали з ЛС\n  cartSelectedProducts.addEventListener('click', deleterProduct);\n}\n\n\n\n\n    // ФУНКЦІЯ ВИДАЛЕННЯ ПРОДУКТУ З НАШОГО ПЕРЕЛІКУ \n    function deleterProduct (event) {\n      const currentElementId = event.target.closest('[id]');\n      const actualId = currentElementId ? currentElementId.id : null;\n      \nconsole.log(actualId)\n\n            if (event.target.closest('.cart-remove-product-btn')) {\n              let cart = localStorageCheck();\n\n              const refreshedArray = cart.filter(product => product._id !== actualId);\n console.log(refreshedArray)\n\n              if (refreshedArray.length > 0) {\n                           localStorage.setItem('cart', JSON.stringify(refreshedArray));\n\n                const refreshedMarkup = localStorageCheck().map(el => {\n                  return selectedProductsMarkup(el._id, el.name, el.img, el.category, el.size, el.price) \n                  // return selectedProductsMarkup(el._id, el.Productame, el.ProductImg, el.ProductCategory, el.ProductSize, el.ProductPrice) -або так\n                }).join('');\n                  \n                 cartSelectedProducts.innerHTML = refreshedMarkup;\n                 totalSumMarkup(refreshedArray);\n                 cartItemsQuantity.innerHTML = refreshedArray.length;\n\n              } else {\n              localStorage.removeItem('cart');\n\n              cartItemsQuantity.innerHTML = '0';\n              cartSelectedProducts.innerHTML = \"\";\n              cartEmptyShow();\n              cartContainerHidden();\n            }\n             } \n            return\n           \n      }\n\n\n\n\n\n\n\n\n    // Слухач на форму по сабміту а ще треба буде по кліку на кнопку\nform.addEventListener('change', (event) => {\n    event.preventDefault();\n    console.log(input.value) \n    input.value = \"\";\n})\n\n\n//Слухач на кнопку Сабміту\nbtnCheckout.addEventListener('click', (event) => {\n  event.preventDefault();\n  console.log('Submit successful')\n\n  // після сабміту замовлення можемо видалити дані зі сховища та приховати\n  cartEmptyShow();\n  cartContainerHidden();\n  cartItemsQuantity.innerHTML = '0';\n  cartSelectedProducts.innerHTML = \"\";\nlocalStorage.removeItem('cart')\n\n// потім тут прописати відкриття модалки про успішні закупи.\n\n})\n\n\n\n\n\n// Слухач на кнопку видалення всього\ndeleteAllBtn.addEventListener('click', removeLocalStorage);\n// ФУНКЦІЯ ОЧИЩЕННЯ СХОВИЩА ВІД ВСІХ ПРОДУКТІВ\nfunction removeLocalStorage(event){\n    event.preventDefault();\n    localStorage.removeItem('cart'); // очищую сховище (за моїм ключем)\n    // localStorage.clear(); - або все очистити \n    cartSelectedProducts.innerHTML = \"\";\n    cartContainerHidden(); // приховую контейнер кошика\n    cartEmptyShow();             // показую пустий кошик\n// cartEmptyHidden();\n// cartContainerHidden();\ncartItemsQuantity.innerHTML = '0';\n}\n\n\n\n//ФУНКЦІЯ ПІДРАХУНКУ СУМИ i РЕНДЕРУ ЇЇ В HTML\nfunction totalSumMarkup (array) {\n  // метод редюс буде рахувати мені суму цін за всі продукти. Потім цей результат я буду передавати в Тотал під час перевірки.\n  const sumPrice = array.reduce((acc, currentProduct)=>{\n    return acc + currentProduct.price;\n      }, 0).toFixed(2);\n\n    totalOrderedPrice.innerHTML = `$${sumPrice}`;\n}\n\n\n// ФУНКЦІЯ ВІДМАЛЬОВУВАННЯ ОБРАНИХ ТОВАРІВ\nfunction selectedProductsMarkup(\n  productId,\n  productName,\n  productImg,\n  productCategory,\n  productSize,\n  productPrice\n) {\n  return `\n<div class=\"selected-item\" id=\"${productId}\">\n    <button class=\"cart-remove-product-btn\"><svg class=\"js-delete-product-icon\"><use href=\"./img/icons.svg#icon-ion_close-sharp\"></use></svg></button>\n    <div class=\"js-selected-item-img\"><img class='js-product-item-img' src=\"${productImg}\" alt=\"Product\"></div>\n    <div class=\"js-selected-item-descroption\">\n        <p class=\"js-item-product-name\">${productName}</p>\n        <p class=\"js-item-product-properties\">Category: <span class=\"js-item-product-descr\">${productCategory}</span> Size: <span class=\"js-item-product-descr\">${productSize}</span></p>\n        <p class=\"js-item-product-price\">$${productPrice}</p>\n    </div>\n</div>\n<p class=\"underline\"></p>\n`\n}\n\n\n\n\n\n// функції помічники які будуть викликатись навзаєм в залежності від того чи в локальному сховищі щось є\n\n// ФУНКЦІЯ ПОКАЗУ ПОРОЖНЬОГО КОШИКА - EMPTY\nfunction cartEmptyShow () {\n    cartEmpty.style.display = 'flex';\n}\n// ФУНКЦІЯ ПРИХОВУВАННЯ ПОРОЖНЬОГО КОШИКА - EMPTY\nfunction cartEmptyHidden () {\n    cartEmpty.style.display = 'none';\n}\n\n\n// ФУНКЦІЯ ПОКАЗУ ПОРОЖНЬОГО КОНТЕЙНЕРУ\nfunction cartContainerShow () {\n    cartContainer.style.display = 'flex';\n}\n// ФУНКЦІЯ Приховування ПОРОЖНЬОГО КОНТЕЙНЕРУ\n// --------- буду викликати функцію яка приховує вміст коли отриманий результат запиту буде не порожнім\nfunction cartContainerHidden () {\n    cartContainer.style.display = 'none';\n}\n\n\nconsole.log(\"Test end\");\n"],"names":["cartItemsQuantity","cartEmpty","cartContainer","deleteAllBtn","cartSelectedProducts","totalOrderedPrice","form","btnCheckout","input","cartEmptyHidden","cartContainerHidden","localStorageCheck","savedProducts","parsedSavedProducts","cartEmptyShow","cartContainerShow","productsArrayMarkup","el","selectedProductsMarkup","totalSumMarkup","deleterProduct","event","currentElementId","actualId","refreshedArray","product","refreshedMarkup","removeLocalStorage","array","sumPrice","acc","currentProduct","productId","productName","productImg","productCategory","productSize","productPrice"],"mappings":"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"}