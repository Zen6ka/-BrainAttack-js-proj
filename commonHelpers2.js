var E=Object.defineProperty;var N=(e,r,t)=>r in e?E(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var S=(e,r,t)=>(N(e,typeof r!="symbol"?r+"":r,t),t);import"./assets/cart-a12976cc.js";import{a as b}from"./assets/vendor-27c5a77b.js";class f{constructor(r,t){S(this,"baseUrl","https://food-boutique.b.goit.study/api/");this.endPoint=r,this.filters=t}async fetchBreeds(){try{const r=await b.get(`${this.baseUrl}${this.endPoint}?${this.filters}&limit=10`);return console.log(r.data),r.data}catch(r){console.error("Error:",r.message)}}}const w=document.querySelector(".search-form"),J=document.querySelector(".first-input-search"),P=document.querySelector(".filters-result"),q=document.querySelector(".first-select-search-not-focus"),y=document.querySelector(".button-categories"),T=document.querySelector(".span-button-categories"),m="products";let d="",i={},a={},u={},v="";const R=()=>{const e=`<div class="error">
    <p class="title-error">
        Nothing was found for the selected <span><a class="a-title-error" href="">filters...</a></span>
    </p>
    <p class="p-error">
        Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.
    </p>
</div>`;P.innerHTML=e};async function I(){try{const e=localStorage.getItem("products-home-page-filters");e?i=JSON.parse(e):(i=(await new f(m,d).fetchBreeds()).results,localStorage.setItem("products-home-page-filters",JSON.stringify(i)))}catch(e){console.error("Error:",e.message)}console.log(i)}I();w.addEventListener("submit",e=>{e.preventDefault();const r=J.value.trim(),t=localStorage.getItem("all-value-input");$(r,t,v)});async function $(e,r,t){let s=localStorage.getItem("result-search-filters");if(!e&&t==="")I(),P.innerHTML="";else if(r){const o=JSON.parse(r);o.push(e);const c=o.filter((n,l,g)=>g.indexOf(n)===l);localStorage.setItem("all-value-input",JSON.stringify(c)),console.log(c),o.find(n=>n===e)&&s?(a=JSON.parse(s).filter(l=>l.name.toLowerCase().includes(e.toLowerCase())).filter(l=>l.category===t),Object.keys(a).length===0&&await p(s,e,t),console.log(a)):p(s,e,t)}else console.log([e]),localStorage.setItem("all-value-input",JSON.stringify([e])),p(s,e,t)}async function p(e,r,t){d=`keyword=${r}&category=${t}`;const o=await new f(m,d).fetchBreeds();if(a=o.results,console.log(a),o.totalPages===0)R();else if(e){const c=JSON.parse(e);a.forEach(l=>{c.find(g=>g._id===l._id)||c.push(l)}),localStorage.setItem("result-search-filters",JSON.stringify(c)),console.log(c)}else console.log(a),localStorage.setItem("result-search-filters",JSON.stringify(a));console.log(a)}async function k(){try{const e=localStorage.getItem("categories-filters");if(e)u=JSON.parse(e);else{const r=`${m}/categories`;u=await new f(r,d).fetchBreeds(),localStorage.setItem("categories-filters",JSON.stringify(u))}}catch(e){console.error("Error:",e.message)}H(u)}k();function H(e){const r=[];e.forEach(s=>{const o=`<li class="li-first-select-search"><button class="button-li-filters">${s.replace(/_/g," ").replace(/&/g,"/")}</button></li>`;r.push(o)}),q.insertAdjacentHTML("beforeend",r.join(""));const t=document.querySelectorAll(".button-li-filters");F(t)}y.addEventListener("click",()=>B(y,q));function B(e,r){r.classList.add("first-select-search"),document.addEventListener("click",t=>D(t,e,r))}function D(e,r,t){!r.contains(e.target)&&!t.contains(e.target)?t.classList.remove("first-select-search"):t.contains(e.target)&&setTimeout(()=>{t.classList.remove("first-select-search")},100)}function F(e){e.forEach(r=>{r.addEventListener("click",_)})}function _(e){const r=e.currentTarget.textContent;v=r.replace(/ /g,"_").replace(/\//g,"&"),T.innerHTML=`${r}`}document.addEventListener("DOMContentLoaded",async function(){const e=new f("products/popular?limit=5");try{const r=z();if(r)h(r);else{const t=await e.fetchBreeds();x(t),h(t)}}catch(r){console.error("Error:",r)}});function x(e){localStorage.setItem("popularProducts",JSON.stringify(e))}function z(){const e=localStorage.getItem("popularProducts");return e?JSON.parse(e):null}function h(e){const r=document.querySelectorAll(".product-template");r.forEach(t=>{t.style.display="none",t.querySelector(".product-image").src="",t.querySelector(".product-name").textContent="",t.querySelector(".category-value").textContent="",t.querySelector(".size-value").textContent="",t.querySelector(".popularity-value").textContent=""}),e.slice(0,r.length).forEach((t,s)=>{const o=r[s];o.style.display="flex",o.querySelector(".product-image").src=t.img,o.querySelector(".product-name").textContent=t.name,o.querySelector(".category-value").textContent=t.category.replace("_"," "),o.querySelector(".size-value").textContent=t.size,o.querySelector(".popularity-value").textContent=t.popularity;const c={productId:t._id,productName:t.name,productImg:t.img,productCategory:t.category,productPrice:t.price,productSize:t.size,productIs10PercentOff:t.is10PercentOff,productPopularity:t.popularity},n=o.querySelector(".add-to-cart-btn");n.onclick=function(){L(c)}})}function L(e){const r=JSON.parse(localStorage.getItem("cart"))||{};return r[e.productId]||(r[e.productId]=e,localStorage.setItem("cart",JSON.stringify(r))),e}const O="",C=document.querySelector(`button[data-product-id="${O}"]`);C&&C.addEventListener("click",()=>{L(O)});
//# sourceMappingURL=commonHelpers2.js.map
