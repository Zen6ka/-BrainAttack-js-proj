var F=Object.defineProperty;var N=(t,e,o)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var h=(t,e,o)=>(N(t,typeof e!="symbol"?e+"":e,o),o);import"./assets/cart-5f857e16.js";import{a as v}from"./assets/vendor-27c5a77b.js";class g{constructor(e,o,s,a){h(this,"baseUrl","https://food-boutique.b.goit.study/api/");this.endPoint=e,this.filters=o,this.page=s,this.limit=a}async fetchBreeds(){try{const e=await v.get(`${this.baseUrl}${this.endPoint}?${this.filters}&page=${this.page}&limit=${this.limit}`);return console.log(e.data),e.data}catch(e){console.error("Error:",e.message)}}}const B=document.querySelector(".search-form"),J=document.querySelector(".first-input-search"),D=document.querySelector(".filters-result"),E=document.querySelector(".first-select-search-not-focus"),S=document.querySelector(".button-categories"),z=document.querySelector(".span-button-categories"),M=document.querySelector(".card-list"),L="products";let m="",p="",i=1,d=6,c={},C={},l={},n={};function P(t,e,o,s){localStorage.setItem("data-for-search",JSON.stringify({keyword:t,category:e,page:o,limit:s}))}P(m,p,i,d);async function w(){const t=JSON.parse(localStorage.getItem("data-for-search")),e=`keyword=${t.keyword}&category=${t.category}`;n=await new g(L,e,i,d).fetchBreeds()}const R=()=>{const t=`<div class="error">
    <p class="title-error">
        Nothing was found for the selected <span><a class="a-title-error" href="">filters...</a></span>
    </p>
    <p class="p-error">
        Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.
    </p>
</div>`;D.innerHTML=t};async function H(){try{const t=localStorage.getItem("products-home-page-filters");t?c=JSON.parse(t):(await w(),c=n.results,console.log(n),localStorage.setItem("products-home-page-filters",JSON.stringify(c)))}catch(t){console.error("Error:",t.message)}console.log(c),K(c)}H();B.addEventListener("submit",async t=>{t.preventDefault(),m=J.value.trim(),P(m,p,i,d),await w(),C=n.results,console.log(C),n.totalPages===0&&R()});async function j(){try{const t=localStorage.getItem("categories-filters");if(t)l=JSON.parse(t);else{const e="",o=`${L}/categories`;l=await new g(o,e,i,d).fetchBreeds(),localStorage.setItem("categories-filters",JSON.stringify(l))}}catch(t){console.error("Error:",t.message)}A(l)}j();function A(t){const e=[];t.forEach(s=>{const a=`<li class="li-first-select-search"><button class="button-li-filters">${s.replace(/_/g," ").replace(/&/g,"/")}</button></li>`;e.push(a)}),E.insertAdjacentHTML("beforeend",e.join(""));const o=document.querySelectorAll(".button-li-filters");W(o)}S.addEventListener("click",()=>_(S,E));function _(t,e){e.classList.add("first-select-search"),document.addEventListener("click",o=>U(o,t,e))}function U(t,e,o){!e.contains(t.target)&&!o.contains(t.target)?o.classList.remove("first-select-search"):o.contains(t.target)&&setTimeout(()=>{o.classList.remove("first-select-search")},100)}function W(t){t.forEach(e=>{e.addEventListener("click",G)})}function G(t){const e=t.currentTarget.textContent;p=e.replace(/ /g,"_").replace(/\//g,"&"),z.innerHTML=`${e}`}function K(t){const e=[];t.forEach(o=>{const s=`<li class="card-list-item id-for-del" data-id=${o._id}>
                <img src="${o.img}" loading="lazy" class="cardlist-img" alt="${o.name}" onerror="this.onerror=null;this.src='';" width=300>
                <h3 class="card-list-product">${o.name}</h3>
                <ul class="cardlist-descr">
                    <li class ="li-p-cards"><span class ="span-p-cards">Category: </span>${o.category}</li>
                    <li class ="li-p-cards"><span class ="span-p-cards">Size: </span>${o.size}</li>
                    <li class ="li-p-cards"><span class ="span-p-cards">Popularity: </span>${o.popularity}</li>
                </ul>
                <div class="cartlist-btn"><button class="cardlist-add-cart add-to-cart-product ">
                <svg class="cardlist-svg" weight="18" height="18">
                <use href=""#cart"></use>
                </svg>
                </button>
                </div>
                </li>`;e.push(s)}),M.innerHTML=e.join(" ")}document.addEventListener("DOMContentLoaded",async function(){const t=new g("products/popular?limit=5");try{const e=V();if(e)q(e);else{const o=await t.fetchBreeds();Q(o),q(o)}}catch(e){console.error("Error:",e)}});function Q(t){localStorage.setItem("popularProducts",JSON.stringify(t))}function V(){const t=localStorage.getItem("popularProducts");return t?JSON.parse(t):null}function q(t){const e=document.querySelectorAll(".product-template");e.forEach(o=>{o.style.display="none",o.querySelector(".product-image").src="",o.querySelector(".product-name").textContent="",o.querySelector(".category-value").textContent="",o.querySelector(".size-value").textContent="",o.querySelector(".popularity-value").textContent=""}),t.slice(0,e.length).forEach((o,s)=>{const a=e[s];a.style.display="flex",a.querySelector(".product-image").src=o.img,a.querySelector(".product-name").textContent=o.name,a.querySelector(".category-value").textContent=o.category.replace("_"," "),a.querySelector(".size-value").textContent=o.size,a.querySelector(".popularity-value").textContent=o.popularity;const k={productId:o._id,productName:o.name,productImg:o.img,productCategory:o.category,productPrice:o.price,productSize:o.size,productIs10PercentOff:o.is10PercentOff,productPopularity:o.popularity},O=a.querySelector(".add-to-cart-btn");O.onclick=function(){I(k)}})}function I(t){const e=JSON.parse(localStorage.getItem("cart"))||{};return e[t.productId]||(e[t.productId]=t,localStorage.setItem("cart",JSON.stringify(e))),t}const T="",b=document.querySelector(`button[data-product-id="${T}"]`);b&&b.addEventListener("click",()=>{I(T)});const r={openModalBtn:document.querySelector('[data-action="open-modal"]'),closeModalBtn:document.querySelector('[data-action="close-modal"]'),backdrop:document.querySelector(".js-backdrop"),addToCart:document.querySelector(".modal-btn-sabmit"),discountProduct:document.querySelector(".modal-discount-svg"),onCart:document.querySelector(".modal-btn-sabmit-span"),modalImg:document.querySelector(".modal-img img"),modalTitle:document.querySelector(".modal-title"),modalCategory:document.querySelector(".modal-list li:nth-child(1) .modal-item-span"),modalSize:document.querySelector(".modal-list li:nth-child(2) .modal-item-span"),modalPopularity:document.querySelector(".modal-list li:nth-child(3) .modal-item-span"),modalDesc:document.querySelector(".modal-info-taxt"),modalPrice:document.querySelector(".modal-price")};r.openModalBtn.addEventListener("click",Y);r.closeModalBtn.addEventListener("click",y);r.backdrop.addEventListener("click",rt);const X="https://food-boutique.b.goit.study/api/";async function Y(){const t=this.dataset.productId;await tt(t),window.addEventListener("keydown",$),document.body.classList.add("show-modal"),x(t)}async function Z(t){try{return(await v.get(`${X}products/${t}`)).data}catch(e){return console.error("Error:",e.message),null}}async function tt(t){const e=await Z(t);e&&(r.modalImg.src=e.img,r.modalImg.alt=e.name,r.modalTitle.textContent=e.name,r.modalCategory.textContent=e.category,r.modalSize.textContent=e.size,r.modalPopularity.textContent=e.popularity,r.modalDesc.textContent=e.desc,r.modalPrice.textContent=`$${e.price.toFixed(2)}`,x(t))}function u(t){const e=t?"Remove from":"Add to";r.addToCart.querySelector(".modal-btn-sabmit-span").textContent=e,r.addToCart.disabled=t}function x(t){const o=f().includes(t);u(o),r.addToCart.addEventListener("click",()=>{o?(ot(t),u(!1),r.addToCart.removeEventListener("click",null)):(et(t),u(!0))})}function f(){return JSON.parse(localStorage.getItem("cart"))||[]}function et(t){let e=f();e.includes(t)||(e.push(t),localStorage.setItem("cart",JSON.stringify(e)))}function ot(t){let e=f();const o=e.indexOf(t);o!==-1&&(e.splice(o,1),localStorage.setItem("cart",JSON.stringify(e)))}function y(){window.removeEventListener("keydown",$),document.body.classList.remove("show-modal")}function rt(t){t.currentTarget===t.target&&y()}function $(t){t.code==="Escape"&&y()}
//# sourceMappingURL=commonHelpers2.js.map
