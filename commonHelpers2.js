var x=Object.defineProperty;var B=(e,t,o)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var q=(e,t,o)=>(B(e,typeof t!="symbol"?t+"":t,o),o);import"./assets/cart-3634bab3.js";import{a as E}from"./assets/vendor-27c5a77b.js";class f{constructor(t,o){q(this,"baseUrl","https://food-boutique.b.goit.study/api/");this.endPoint=t,this.filters=o}async fetchBreeds(){try{const t=await E.get(`${this.baseUrl}${this.endPoint}?${this.filters}&limit=10`);return console.log(t.data),t.data}catch(t){console.error("Error:",t.message)}}}const $=document.querySelector(".search-form"),R=document.querySelector(".first-input-search"),L=document.querySelector(".filters-result"),w=document.querySelector(".first-select-search-not-focus"),P=document.querySelector(".button-categories"),D=document.querySelector(".span-button-categories"),S="products";let m="",d={},n={},u={},I="";const F=()=>{const e=`<div class="error">
    <p class="title-error">
        Nothing was found for the selected <span><a class="a-title-error" href="">filters...</a></span>
    </p>
    <p class="p-error">
        Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.
    </p>
</div>`;L.innerHTML=e};async function O(){try{const e=localStorage.getItem("products-home-page-filters");e?d=JSON.parse(e):(d=(await new f(S,m).fetchBreeds()).results,localStorage.setItem("products-home-page-filters",JSON.stringify(d)))}catch(e){console.error("Error:",e.message)}console.log(d)}O();$.addEventListener("submit",e=>{e.preventDefault();const t=R.value.trim(),o=localStorage.getItem("all-value-input");M(t,o,I)});async function M(e,t,o){let a=localStorage.getItem("result-search-filters");if(!e&&o==="")O(),L.innerHTML="";else if(t){const r=JSON.parse(t);r.push(e);const c=r.filter((i,l,g)=>g.indexOf(i)===l);localStorage.setItem("all-value-input",JSON.stringify(c)),console.log(c),r.find(i=>i===e)&&a?(n=JSON.parse(a).filter(l=>l.name.toLowerCase().includes(e.toLowerCase())).filter(l=>l.category===o),Object.keys(n).length===0&&await p(a,e,o),console.log(n)):p(a,e,o)}else console.log([e]),localStorage.setItem("all-value-input",JSON.stringify([e])),p(a,e,o)}async function p(e,t,o){m=`keyword=${t}&category=${o}`;const r=await new f(S,m).fetchBreeds();if(n=r.results,console.log(n),r.totalPages===0)F();else if(e){const c=JSON.parse(e);n.forEach(l=>{c.find(g=>g._id===l._id)||c.push(l)}),localStorage.setItem("result-search-filters",JSON.stringify(c)),console.log(c)}else console.log(n),localStorage.setItem("result-search-filters",JSON.stringify(n));console.log(n)}async function z(){try{const e=localStorage.getItem("categories-filters");if(e)u=JSON.parse(e);else{const t=`${S}/categories`;u=await new f(t,m).fetchBreeds(),localStorage.setItem("categories-filters",JSON.stringify(u))}}catch(e){console.error("Error:",e.message)}H(u)}z();function H(e){const t=[];e.forEach(a=>{const r=`<li class="li-first-select-search"><button class="button-li-filters">${a.replace(/_/g," ").replace(/&/g,"/")}</button></li>`;t.push(r)}),w.insertAdjacentHTML("beforeend",t.join(""));const o=document.querySelectorAll(".button-li-filters");j(o)}P.addEventListener("click",()=>A(P,w));function A(e,t){t.classList.add("first-select-search"),document.addEventListener("click",o=>_(o,e,t))}function _(e,t,o){!t.contains(e.target)&&!o.contains(e.target)?o.classList.remove("first-select-search"):o.contains(e.target)&&setTimeout(()=>{o.classList.remove("first-select-search")},100)}function j(e){e.forEach(t=>{t.addEventListener("click",U)})}function U(e){const t=e.currentTarget.textContent;I=t.replace(/ /g,"_").replace(/\//g,"&"),D.innerHTML=`${t}`}document.addEventListener("DOMContentLoaded",async function(){const e=new f("products/popular?limit=5");try{const t=V();if(t)b(t);else{const o=await e.fetchBreeds();W(o),b(o)}}catch(t){console.error("Error:",t)}});function W(e){localStorage.setItem("popularProducts",JSON.stringify(e))}function V(){const e=localStorage.getItem("popularProducts");return e?JSON.parse(e):null}function b(e){const t=document.querySelectorAll(".product-template");t.forEach(o=>{o.style.display="none",o.querySelector(".product-image").src="",o.querySelector(".product-name").textContent="",o.querySelector(".category-value").textContent="",o.querySelector(".size-value").textContent="",o.querySelector(".popularity-value").textContent=""}),e.slice(0,t.length).forEach((o,a)=>{const r=t[a];r.style.display="flex",r.querySelector(".product-image").src=o.img,r.querySelector(".product-name").textContent=o.name,r.querySelector(".category-value").textContent=o.category.replace("_"," "),r.querySelector(".size-value").textContent=o.size,r.querySelector(".popularity-value").textContent=o.popularity;const c={productId:o._id,productName:o.name,productImg:o.img,productCategory:o.category,productPrice:o.price,productSize:o.size,productIs10PercentOff:o.is10PercentOff,productPopularity:o.popularity},i=r.querySelector(".add-to-cart-btn");i.onclick=function(){T(c)}})}function T(e){const t=JSON.parse(localStorage.getItem("cart"))||{};return t[e.productId]||(t[e.productId]=e,localStorage.setItem("cart",JSON.stringify(t))),e}const k="",v=document.querySelector(`button[data-product-id="${k}"]`);v&&v.addEventListener("click",()=>{T(k)});const s={openModalBtn:document.querySelector('[data-action="open-modal"]'),closeModalBtn:document.querySelector('[data-action="close-modal"]'),backdrop:document.querySelector(".js-backdrop"),addToCart:document.querySelector(".modal-btn-sabmit"),discountProduct:document.querySelector(".modal-discount-svg"),onCart:document.querySelector(".modal-btn-sabmit-span"),modalImg:document.querySelector(".modal-img img"),modalTitle:document.querySelector(".modal-title"),modalCategory:document.querySelector(".modal-list li:nth-child(1) .modal-item-span"),modalSize:document.querySelector(".modal-list li:nth-child(2) .modal-item-span"),modalPopularity:document.querySelector(".modal-list li:nth-child(3) .modal-item-span"),modalDesc:document.querySelector(".modal-info-taxt"),modalPrice:document.querySelector(".modal-price")};s.openModalBtn.addEventListener("click",K);s.closeModalBtn.addEventListener("click",C);s.backdrop.addEventListener("click",ee);const G="https://food-boutique.b.goit.study/api/";async function K(){const e=this.dataset.productId;await X(e),window.addEventListener("keydown",J),document.body.classList.add("show-modal"),N(e)}async function Q(e){try{return(await E.get(`${G}products/${e}`)).data}catch(t){return console.error("Error:",t.message),null}}async function X(e){const t=await Q(e);t&&(s.modalImg.src=t.img,s.modalImg.alt=t.name,s.modalTitle.textContent=t.name,s.modalCategory.textContent=t.category,s.modalSize.textContent=t.size,s.modalPopularity.textContent=t.popularity,s.modalDesc.textContent=t.desc,s.modalPrice.textContent=`$${t.price.toFixed(2)}`,N(e))}function y(e){const t=e?"Remove from":"Add to";s.addToCart.querySelector(".modal-btn-sabmit-span").textContent=t,s.addToCart.disabled=e}function N(e){const o=h().includes(e);y(o),s.addToCart.addEventListener("click",()=>{o?(Z(e),y(!1),s.addToCart.removeEventListener("click",null)):(Y(e),y(!0))})}function h(){return JSON.parse(localStorage.getItem("cart"))||[]}function Y(e){let t=h();t.includes(e)||(t.push(e),localStorage.setItem("cart",JSON.stringify(t)))}function Z(e){let t=h();const o=t.indexOf(e);o!==-1&&(t.splice(o,1),localStorage.setItem("cart",JSON.stringify(t)))}function C(){window.removeEventListener("keydown",J),document.body.classList.remove("show-modal")}function ee(e){e.currentTarget===e.target&&C()}function J(e){e.code==="Escape"&&C()}
//# sourceMappingURL=commonHelpers2.js.map
