var L=Object.defineProperty;var E=(e,t,r)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var m=(e,t,r)=>(E(e,typeof t!="symbol"?t+"":t,r),r);import"./assets/cart-601d3f2b.js";import{a as w}from"./assets/vendor-27c5a77b.js";class f{constructor(t,r){m(this,"baseUrl","https://food-boutique.b.goit.study/api/");this.endPoint=t,this.filters=r}async fetchBreeds(){try{const t=await w.get(`${this.baseUrl}${this.endPoint}?${this.filters}&limit=10`);return console.log(t.data),t.data}catch(t){console.error("Error:",t.message)}}}const O=document.querySelector(".search-form"),b=document.querySelector(".first-input-search"),C=document.querySelector(".filters-result"),q=document.querySelector(".first-select-search-not-focus"),S=document.querySelector(".button-categories"),N=document.querySelector(".span-button-categories"),h="products";let d="",i={},a={},u={},P="";const J=()=>{const e=`<div class="error">
    <p class="title-error">
        Nothing was found for the selected <span><a class="a-title-error" href="">filters...</a></span>
    </p>
    <p class="p-error">
        Try adjusting your search parameters or browse our range by other criteria to find the perfect product for you.
    </p>
</div>`;C.innerHTML=e};async function v(){try{const e=localStorage.getItem("products-home-page-filters");e?i=JSON.parse(e):(i=(await new f(h,d).fetchBreeds()).results,localStorage.setItem("products-home-page-filters",JSON.stringify(i)))}catch(e){console.error("Error:",e.message)}console.log(i)}v();O.addEventListener("submit",e=>{e.preventDefault();const t=b.value.trim(),r=localStorage.getItem("all-value-input");I(t,r,P)});async function I(e,t,r){let o=localStorage.getItem("result-search-filters");if(!e&&r==="")v(),C.innerHTML="";else if(t){const s=JSON.parse(t);s.push(e);const c=s.filter((n,l,g)=>g.indexOf(n)===l);localStorage.setItem("all-value-input",JSON.stringify(c)),console.log(c),s.find(n=>n===e)&&o?(a=JSON.parse(o).filter(l=>l.name.toLowerCase().includes(e.toLowerCase())).filter(l=>l.category===r),Object.keys(a).length===0&&await p(o,e,r),console.log(a)):p(o,e,r)}else console.log([e]),localStorage.setItem("all-value-input",JSON.stringify([e])),p(o,e,r)}async function p(e,t,r){d=`keyword=${t}&category=${r}`;const s=await new f(h,d).fetchBreeds();if(a=s.results,console.log(a),s.totalPages===0)J();else if(e){const c=JSON.parse(e);a.forEach(l=>{c.find(g=>g._id===l._id)||c.push(l)}),localStorage.setItem("result-search-filters",JSON.stringify(c)),console.log(c)}else console.log(a),localStorage.setItem("result-search-filters",JSON.stringify(a));console.log(a)}async function T(){try{const e=localStorage.getItem("categories-filters");if(e)u=JSON.parse(e);else{const t=`${h}/categories`;u=await new f(t,d).fetchBreeds(),localStorage.setItem("categories-filters",JSON.stringify(u))}}catch(e){console.error("Error:",e.message)}R(u)}T();function R(e){const t=[];e.forEach(o=>{const s=`<li class="li-first-select-search"><button class="button-li-filters">${o.replace(/_/g," ").replace(/&/g,"/")}</button></li>`;t.push(s)}),q.insertAdjacentHTML("beforeend",t.join(""));const r=document.querySelectorAll(".button-li-filters");k(r)}S.addEventListener("click",()=>H(S,q));function H(e,t){t.classList.add("first-select-search"),document.addEventListener("click",r=>$(r,e,t))}function $(e,t,r){!t.contains(e.target)&&!r.contains(e.target)?r.classList.remove("first-select-search"):r.contains(e.target)&&setTimeout(()=>{r.classList.remove("first-select-search")},100)}function k(e){e.forEach(t=>{t.addEventListener("click",D)})}function D(e){const t=e.currentTarget.textContent;P=t.replace(/ /g,"_").replace(/\//g,"&"),N.innerHTML=`${t}`}document.addEventListener("DOMContentLoaded",async function(){const e=new f("products/popular?limit=5");try{const t=F();if(t)y(t);else{const r=await e.fetchBreeds();B(r),y(r)}}catch(t){console.error("Error:",t)}});function B(e){localStorage.setItem("popularProducts",JSON.stringify(e))}function F(){const e=localStorage.getItem("popularProducts");return e?JSON.parse(e):null}function y(e){const t=document.querySelectorAll(".product-template");t.forEach(r=>{r.style.display="none",r.querySelector(".product-image").src="",r.querySelector(".product-name").textContent="",r.querySelector(".category-value").textContent="",r.querySelector(".size-value").textContent="",r.querySelector(".popularity-value").textContent=""}),e.slice(0,t.length).forEach((r,o)=>{const s=t[o];s.style.display="flex",s.querySelector(".product-image").src=r.img,s.querySelector(".product-name").textContent=r.name,s.querySelector(".category-value").textContent=r.category.replace("_"," "),s.querySelector(".size-value").textContent=r.size,s.querySelector(".popularity-value").textContent=r.popularity;const c=s.querySelector(".add-to-cart-btn");c.onclick=function(){addToCart(r._id)}})}
//# sourceMappingURL=commonHelpers2.js.map
